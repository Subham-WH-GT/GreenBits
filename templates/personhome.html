

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>GreenBits - E-Waste Management</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(to right, #ffeb3bd9, #178d1c);

        }

        header {
            /* background: #4CAF50; */
            color: rgb(9, 8, 8);
            padding: 15px;
            text-align: center;
            font-size: 24px;
            font-family: cursive;
        }

        .container {
            /* width: 90%; */
            margin-top: 33px;
            overflow: hidden;
            padding: 20px;
            /* background:#7fb83de6; */
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            border-color: black;
            border-style: solid;
        }

        .hero {
            text-align: center;
            padding: 50px;
            background: url('/static/images/bck3.jpg') no-repeat center center/cover;
            color: rgb(247, 241, 241);
            border-radius: 10px;
        }

        .hero h1 {
            margin: 0;
            font-size: 36px;
            color: black;
        }

        .hero p {
            font-size: 18px;
            color: black;
        }

        .features {
            display: flex;
            justify-content: space-between;
            /* background: url('/static/images/bck2.jpg') no-repeat center center/cover; */
            margin-top: 30px;
        }

        .feature-box {
            flex: 1;
            padding: 20px;
            font-size: 17px;
            font-family: cursive;
            background: #e8f5e9;
            text-align: center;
            margin: 10px;
            /* background: url(/static/images/bck2.jpg) no-repeat center center / cover; */
            border-radius: 10px;
            background-attachment: fixed;
        }
        .feature-box h2{
            font-weight: 900;
        }
        .feature-box:hover {
            cursor: pointer;
            border-color: black;
            border-style: solid;
            background-color: #28a745;
        }

        .footer {
            text-align: center;
            padding: 20px;
            background: #4CAF50;
            color: white;
            margin-top: 20px;
        }

        #username {
            color: black;
            font-style: italic;
            font-variant: all-small-caps;
            font-weight: 700;
            text-decoration: overline;
        }

        .ai-image-process h1 {
            font-size: 2.5rem;
            color: darkseagreen;
        }

        .ai-image-process {
            /* background-image: url('/static/images/tree.jpg'); */
            background-size: cover;
            background-repeat: no-repeat;
            color: antiquewhite;
            border-style: solid;
            border-color: #4CAF50;
            font-family: monospace;
            height: 900px;
            /* width: 70%; */
            /* background: rgba(255, 255, 255, 0.1); */
            /* margin: 30px; */
            margin-left: 10px;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
            /* width: 90%;
            max-width: 400px; */
            background-color: #8a80806b;
    height: 310px;
    overflow: scroll;
        }

        .nlp-head{
            margin-bottom: 0px;
    font-size: xx-large;
    font-family: monospace;
    font-weight: 800;
    padding: 10px;
margin-top: 3rem;
        }

        h2 {
            margin-bottom: 20px;
        }

        input[type="file"] {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 8px;
            background: transparent;
            color: black;
            cursor: pointer;
        }

        button {
            margin-top: 15px;
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            background: #ffcc00;
            color: black;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
        }

        button:hover {
            background: #ffdd44;
        }

        #result {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
        }

        #uploaded-image {
            display: none;
            width: 150px;
            /* Adjust as needed */
            height: 150px;
            border-radius: 10px;
            object-fit: cover;
            border: 2px solid #ccc;
            margin-top: 10px;
        }

        .card:hover {
            transform: scale(1.05);
            transition: 0.3s;
        }

        .reward-back {
            /* background-image: url('/static/images/re.jpg'); */
            /* background: radial-gradient(circle, #FF5733, #3f51b5c9); */
            border-radius: 30px;
        }

        .me {
            font-size: xxx-large;
            font-weight: 600;
            font-family: monospace;
            color: black;
            padding-left: 38px;
            /* font-style: italic; */
        }

        .walleticon {
            width: 70px;
        }

        .icon {
            font-size: 2.1rem;
            color: seagreen;
            font-weight: 600;
            font-family: monospace;
        }

      
        .wallet-info {
            display: none;
            /* Initially hidden */
            position: absolute;
            top: 60px;
            /* Adjust according to header height */
            right: 20px;
            background-color: white;
            border: 1px solid #ccc;
            padding: 10px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
            border-radius: 5px;
            z-index: 1000;
        }

        .wallet-info p {
            font-size: smaller;
        }

        .redeem-button {
            background-color: green;
            color: white;
            padding: 5px 10px;
            border: none;
            cursor: pointer;
            margin-top: 10px;
            border-radius: 5px;
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px;
            /* background-color: black; */
            margin-bottom: 3rem;

        }

        .card {
            border: 1px solid #ddd;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
            cursor: pointer;
            display: flex;
    flex-direction: column;
        }

        .card:hover {
            transform: scale(1.05);
        }

        .card img {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }

        .feature-container {
            background-color: #8a80806b;
        }

        .feature-container p {

            color: black;
            padding: 10px;
            font-family: cursive;
        }

        .card-content {
            padding: 15px;
            text-align: center;
            background-color: white;
            height: 16rem;
            font-weight: 700;
        }

        .card-content h2 {
            margin: 0;
            font-size: 18px;
        }

        .card-content p {
            color: gray;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .card-grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            }
        }


        .upload-container {
            /* margin: auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
            max-width: 500px;
            background-color: white; */

            margin: auto;
    padding: 75px;
    border: 1px solid #ccc;
    border-radius: 10px;
    box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
    /* max-width: 500px; */
    background-color:#8a80806b;
    width: 98%;
    height: 40rem;
    overflow: scroll;
    /* background-color: #a9a9a9; */
    margin-bottom: 4rem;
        }

        .upload-container label{
            font-weight: 700;
        }

        .upload-container input,
        .upload-container textarea,
        .upload-container select,
        .upload-container button {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

     



        .combine-user {
            display: flex;
            flex-direction: column;
            font-size: 15px;
            align-items: baseline;
            font-weight: 700;
            font-family: monospace;
        }


        .org-item {
            display: flex;
            align-items: center;
            gap: 10px;
            /* Space between checkbox and text */
            padding: 5px 0;
        }

        .org-checkbox {
            transform: scale(1.2);
            /* Make checkbox slightly bigger */
            cursor: pointer;
        }

        .org-name {
            font-size: 16px;
            font-weight: 500;
        }

 


        #notification-menu {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgb(0 0 0);
            color: crimson;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            width: 50%;
            max-width: 400px;
            z-index: 1000;
            display: none;
            /* Hidden by default */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        .notification {
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        }

        .notification:last-child {
            border-bottom: none;
        }

        #close-btn {
            margin-top: 10px;
            padding: 5px 10px;
            background: red;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 5px;
        }

        #notification-btn {
           
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: black;
            transition: 0.3s;
        }

        #notification-btn:hover {
            color: red;
            transform: scale(1.2);
        }



        #delivery-form-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            /* Adjust width as needed */
            max-width: 400px;
            /* Prevents it from getting too wide */
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            /* Prevents overflowing */
        }

        .scrollable-form {
            max-height: 60vh;
            /* Limits height */
            overflow-y: auto;
            /* Enables scrolling */
            padding-right: 10px;
            /* Space for scrollbar */
        }

        #delivery-form {
            display: flex;
            flex-direction: column;
        }

        #delivery-form label {
            font-weight: bold;
            margin-top: 10px;
        }

        #delivery-form input,
        #delivery-form textarea {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        #delivery-form button {
            margin-top: 15px;
            padding: 10px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        #delivery-form button:hover {
            background-color: #0056b3;
        }


        .container2 {
            /* max-width: 600px; */
            margin: 50px auto;
            background: #8a80806b;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            overflow: scroll;
            height: 30rem;
            width: 95%;
            margin-bottom: -1px;
            margin-top: 0px;
        }

        .gemma-head{
            margin-bottom: 0px;
    padding: 28px;
    font-size: xx-large;
    font-family: monospace;
    font-weight: 600;
        }

        textarea {
            width: 100%;
            height: 100px;
            margin-bottom: 10px;
            padding: 10px;
            font-size: 16px;
            border-radius: 9px;
            padding: 10px;
        }

        button {
            background-color: #28a745;
            color: white;
            padding: 10px 15px;
            border: none;
            cursor: pointer;
            font-size: 16px;
        }

        button:hover {
            background-color: #218838;
        }

        p {
            margin-top: 20px;
            font-size: 18px;
            color: #333;
        }

        .note-point p {
            padding: 25px;
            margin-top: -1px;
            color: black;
            font-size: medium;
            font-weight: 600;
            font-family: math;
        }

        .note-point span {
            color: red;
        }
        .notification p{
            color: white;
        }

        .product-detail{
            padding: 16px;
    font-family: monospace;
    font-size: xxx-large;
    font-weight: 600;
        }

        .re{
            background-color:#8a80806b;
        }

        .review-btn{
            background-color: #ff00002b;
    padding: 10px;
    font-size: larger;
    font-weight: 600;
        }



        .modal2 {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 400px;
        background: white;
        padding: 20px;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.3);
        border-radius: 8px;
        z-index: 1000;
    }

    .modal-content2 {
        text-align: center;
    }

    .modal-content2 span{
        font-size: xxx-large;
        cursor: pointer;
    }

    .modal-content2 input, 
    .modal-content2 textarea, 
    .modal-content2 select {
        width: 100%;
        padding: 8px;
        margin: 8px 0;
        border: 2px solid black;
        font-size: x-large;
    }

    #reviewForm label{
        font-size: x-large;
    font-weight: 700;
    }



    .ratings-text {
    color: blue;
    cursor: pointer;
    text-decoration: underline;
    font-weight: bold;
}

.ratings-text:hover {
    color: darkblue;
}


/* .review-card {
    border: 1px solid #ddd;
    padding: 10px;
    margin-bottom: 10px;
    border-radius: 5px;
    background-color: #f9f9f9;
} */



/* Modal Background */
.modal {
    display: none; /* Hidden by default */
    position: fixed;
    z-index: 1000; /* Ensure it appears above everything */
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5); /* Semi-transparent background */
    display: flex;
    justify-content: center;
    align-items: center;
}

/* Modal Content Box */
.modal-content {
    background: white;
    padding: 20px;
    width: 50%; /* Adjust width */
    max-width: 500px; /* Prevent too wide */
    border-radius: 10px;
    text-align: center;
    box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.3);
    animation: fadeIn 0.3s ease-in-out;
}

/* Close Button */
.close {
    position: absolute;
    right: 20px;
    top: 15px;
    font-size: 24px;
    cursor: pointer;
}

/* Reviews Container */
#reviewsContainer {
    max-height: 300px;
    overflow-y: auto; /* Scrollable if too many reviews */
    text-align: left;
    padding: 10px;
}

/* Individual Review */
.review {
    background: #f8f8f8;
    padding: 10px;
    border-radius: 5px;
    margin-bottom: 10px;
    box-shadow: 1px 1px 5px rgba(0, 0, 0, 0.1);
}

/* Smooth Animation */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}



    </style>
</head>

<body>
  

    <header
        style="display: flex; justify-content: space-between; align-items: center; padding: 10px; color: rgb(11, 11, 11);">
        
        <div class="icon">
            GreenBits
        </div>

       

        <div class="noti">

            <button id="notification-btn">
                🔔
            </button>

            <div id="notification-menu">
                <h3>Notifications</h3>
                <div id="notifications-content"></div>
                <button id="close-btn" onclick="closeNotifications()">Close</button>
            </div>

        </div>



        <div id="delivery-form-container" style="display: none;">
            <h3>Enter Delivery Details</h3>
            <div class="scrollable-form">
                <form id="delivery-form">
                    <label>User ID:</label>
                    <input type="text" id="delivery-user-id" required>

                    <label>Email:</label>
                    <input type="email" id="delivery-user-email" required>

                    <label>Contact Number:</label>
                    <input type="text" id="delivery-user-contact" required>


                    <label>Product Id:</label>
                    <input type="text" id="product_id" required>


                    <label>Organisation Id:</label>
                    <input type="text" id="organisation_id" required>

                    <label>Delivery Pincode:</label>
                    <input type="text" id="delivery-pincode" required>



                    <label>Full Address:</label>
                    <textarea id="delivery-location" required></textarea>

                    <label>State:</label>
                    <input type="text" id="delivery-state" required>

                    <button type="submit">Submit</button>
                    <button type="button" onclick="closeDeliveryForm()">Cancel</button>
                </form>
            </div>

        </div>


        
        
        <div style="display: flex; align-items: center; gap: 15px;">
          

            <img class="walleticon" src="static/images/wallet.png" alt="Wallet Icon" onclick="toggleWalletInfo()"
                style="cursor: pointer;">

           
            <div class="wallet-info" id="wallet-info" style="display: none;">
                <p>Current GreenBits in your wallet: <span id="greenbits">{{ user.greenbits }}</span></p>
                <button class="redeem-button">Redeem</button>
            </div>

            <!-- User Name -->
            <div class="combine-user">
                <span id="user-name">{{ user.name }}</span>
                <div class="user-id">User_ID: {{user.uid}}</div>
            </div>


           
            <img id="user-photo" src="{{ user.profile_picture }}" alt="User Photo"
                style="width: 40px; height: 40px; border-radius: 50%;">

            <!-- Logout Button -->
            <button onclick="logout()"
                style="padding: 5px 10px; background-color: red; color: white; border: none; border-radius: 5px; cursor: pointer;">
                Logout
            </button>
        </div>
    </header>

    <div class="container">
        <div class="hero">
            <h1>Join the Movement for a Greener Tomorrow</h1>
            <p>Recycle your e-waste responsibly and contribute to a sustainable future.</p>
        </div>

        <div class="features">
            <div class="feature-box">
                <a href="{{ url_for('nearestcenters') }}">
                <h2>Easy E-Waste Disposal Centers Near you</h2>
                <p>Find nearby e-waste collection centers with just a click.</p>
            </a>
            </div>
            
                <div class="feature-box">
                    
                    <a href="{{ url_for('beforePurchase') }}">
                        <h2>Choose the best Products before Purchase &#9654;</h2>
                    <p>Search your product with budget and get the guidance from the best Techie in the world.</p>
                    </a>
                </div>
            
            <div class="feature-box">
                <a href="{{ url_for('compare') }}">
                <h2>Search & Compare</h2>
                <p>Search among various electronic brands and choose wisely, this would help you to select the best product for your purchase.</p>
            </a>
            </div>
        </div>
    </div>
    <h1 class="nlp-head">Smart-Management Analyzer!</h1>
    <div class="ai-image-process">
       

        <h2>Upload your E-Product</h2>
        <form id="upload-form" enctype="multipart/form-data">
            <input type="file" id="file-input" name="file" accept="image/*" required>
            <button type="submit">Predict</button>
        </form>
        <img id="uploaded-image" src="" alt="Uploaded Image Preview">
        <div id="result"></div>
        <div id="handling-steps" class="handling-steps" style="display: none;"></div>
    </div>



    <!-- Gemma Portion -->
    <h1 class="gemma-head">E-Waste Sustainability Advisor</h1>
    <div class="container2">
        
        <h5>Ask gemma about how you dispose your e-waste</h5>
        <form id="analyzeForm">
            <textarea name="text" id="description"
                placeholder="Enter your prompt -> I have a dead phone, with no battery life, how can i dispose it ?"
                required></textarea>
            <button type="submit">Get Suggestion</button>
        </form>
        <p id="response"></p>
    </div>

    <div class="note-point">
        <p> <span>Note:</span> We have fine-tuned the model in Google Colab, leveraging their support for T4 GPUs and
            high RAM availability. The fine-tuned model has been uploaded to Hugging Face. However, due to GPU
            unavailability and limited RAM on this system, we are unable to integrate the fine-tuned model with the
            current setup.

            For a detailed source and an example of the fine-tuned model, please refer to the link attached below.

            A big thanks to Google Colab for providing the necessary GPU and RAM resources for training! Looking Forward
            to get some resources.<br><a href="/static/gemma-tuned.pdf" target="_blank">📄 Click here to view.</a></p>
        
    </div>


    <h1 style="font-size: xxx-large;font-family: monospace;font-weight: 700;">Prefer your Organisation</h1>
    <div class="feature-container" id="market-insights">
        <p>Please fill the form below and choose your organisation to whom you want your product to sell. Once you
            filled the form, if the organisation approve the product you will be mailed/notified the estimated price
            within 24 hrs. PLEASE dont setback, we will bring more organisations at the earliest!</p>
        <div class="card-grid" id="org-cards"></div>
    </div>




    <div id="reviewsModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" onclick="closeReviewsModal()">&times;</span>
            <h2>Customer Reviews</h2>
            <div id="reviewsContainer">
                <!-- Reviews will be displayed here -->
            </div>
        </div>
    </div>
    



    <div id="reviewModal2" class="modal2">
        <div class="modal-content2">
            <span class="close">&times;</span>
            <h2>Share Your Review</h2>
            <form id="reviewForm">
                <input type="hidden" id="orgId">
                <label for="userId">User ID:</label>
                <input type="text" id="userId" required>
    
                <label for="message">Message:</label>
                <textarea id="message" required></textarea>
    
                <label for="rating">Rating (1-5):</label>
                <select id="rating">
                    <option value="5">⭐️⭐️⭐️⭐️⭐️ (Excellent)</option>
                    <option value="4">⭐️⭐️⭐️⭐️ (Good)</option>
                    <option value="3">⭐️⭐️⭐️ (Average)</option>
                    <option value="2">⭐️⭐️ (Poor)</option>
                    <option value="1">⭐️ (Bad)</option>
                </select>
    
                <button type="submit">Submit Review</button>
            </form>
        </div>
    </div>















    <h2 class="product-detail">Upload E-Waste Product</h2>
    <div class="upload-container">
        


        <label for="product-name">Product Type:</label>
        <input type="text" id="product-name" placeholder="Enter product type- phone/laptop/speaker/micro-oven/tv">

        <label for="product-age">Product Age (in years):</label>
        <input type="number" id="product-age" placeholder="Enter product age">

        <label for="product-brand">Brand:</label>
        <input type="text" id="product-brand" placeholder="Enter brand name">

        <label for="product-model">Model Name/Number:</label>
        <input type="text" id="product-model" placeholder="Enter model name">

        <label for="product-description">Description:</label>
        <textarea id="product-description" placeholder="Enter product details"></textarea>

        <label for="user-id">Your User_ID:</label>
        <input type="text" id="user-id" placeholder="Enter your user id">

        <label for="email">Email:</label>
        <input type="email" id="email" placeholder="Enter active e-mail">

       
        <label>Send to:</label>
        <select id="send-option" onchange="toggleOrgSelection()">
            <option value="all">All Organizations</option>
            <option value="selected">Selected Organizations</option>
        </select>

        
        <div id="org-selection" class="org-selection">
            <h3>Select Organizations:</h3>
           

            <div id="org-list" class="org-list">
                
            </div>
        </div>

       
        <button onclick="submitEwaste()">Send</button>
    </div>


    </div>



    <div class="reward-back">
        <h1 class="me">Earn Your Rewards!</h1>
        <div class="max-w-4xl mx-auto p-6 mt-10 re">
            
            <div class="bg-white p-6 rounded-lg shadow-lg">
                <h2 class="text-2xl font-bold text-green-600">🌱 How to Earn GreenBits</h2>
                <p class="text-gray-600 mt-2">Dispose of your e-waste responsibly and earn GreenBits based on the
                    product size:</p>
                <div class="mt-4 grid grid-cols-1 sm:grid-cols-3 gap-4">
                    <div class="card bg-green-100 p-4 rounded-lg text-center">
                        <h3 class="text-lg font-semibold">📱 Small Product</h3>
                        <p class="text-gray-700">(200g - 1kg)</p>
                        <p class="text-xl font-bold text-green-700">+2 GreenBits</p>
                    </div>
                    <div class="card bg-green-200 p-4 rounded-lg text-center">
                        <h3 class="text-lg font-semibold">💻 Medium Product</h3>
                        <p class="text-gray-700">(1kg - 10kg)</p>
                        <p class="text-xl font-bold text-green-700">+5 GreenBits</p>
                    </div>
                    <div class="card bg-green-300 p-4 rounded-lg text-center">
                        <h3 class="text-lg font-semibold">📺 Large Product</h3>
                        <p class="text-gray-700">(10kg+)</p>
                        <p class="text-xl font-bold text-green-700">+10 GreenBits</p>
                    </div>
                </div>
                <div class="mt-6 p-4 bg-green-50 border-l-4 border-green-400">
                    <h3 class="text-lg font-semibold text-green-700">💡 Earn More GreenBits</h3>
                    <p class="text-gray-700">✔ Continuous 6 months of successful disposal earns <span
                            class="font-bold">+60 GreenBits</span></p>
                    <p class="text-gray-700">✔ Add new users with your invite code and earn <span class="font-bold">+2
                            GreenBits</span> per user</p>
                </div>
            </div>

            <!-- How to Use GreenBits -->
            <div class="bg-white p-6 rounded-lg shadow-lg mt-8">
                <h2 class="text-2xl font-bold text-blue-600">💰 How to Use GreenBits</h2>
                <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div class="card bg-blue-100 p-4 rounded-lg text-center">
                        <h3 class="text-lg font-semibold">🛍️ Shop with GreenBits</h3>
                        <p class="text-gray-700">Use your GreenBits to buy eco-friendly products & exclusive
                            merchandise.</p>
                    </div>
                    <div class="card bg-blue-200 p-4 rounded-lg text-center">
                        <h3 class="text-lg font-semibold">🔖 Discount on Electronics</h3>
                        <p class="text-gray-700">Every <span class="font-bold">60 GreenBits</span> gives you <span
                                class="text-green-700 font-bold">₹12</span> off on your next purchase!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        &copy; 2025 GreenBits | Making E-Waste Management Smarter
    </div>

    <script>



        document.getElementById("analyzeForm").addEventListener("submit", function (event) {
            event.preventDefault(); 

            let description = document.getElementById("description").value;
            let responseElement = document.getElementById("response");

            if (!description) {
                responseElement.innerText = "Please enter a product description!";
                return;
            }

            responseElement.innerText = "Generating suggestion...";

            fetch("/analyze", {
                method: "POST",
                body: new FormData(this)
            })
                .then(response => response.json())
                .then(data => {
                    if (data.suggestion) {
                        responseElement.innerText = "Sustainability Suggestion: " + data.suggestion;
                    } else {
                        responseElement.innerText = "Error: " + data.error;
                    }
                })
                .catch(error => {
                    responseElement.innerText = "Failed to fetch suggestion!";
                    console.error("Error:", error);
                });
        });




        document.getElementById("notification-btn").addEventListener("click", fetchNotifications);


        async function fetchNotifications() {
            let response = await fetch("/get_notifications", {
                method: "GET",
                credentials: "include",
            });

            let data = await response.json();
            console.log("Notifications Response:", data);
            

            let menu = document.getElementById("notification-menu");
            let content = document.getElementById("notifications-content");
            content.innerHTML = "";  // Clear previous notifications

            if (data.notifications && data.notifications.length > 0) {
                data.notifications.forEach(msg => {
                    let div = document.createElement("div");
                    div.classList.add("notification");


                    if (msg.status === "accepted") {
                // Replace buttons with a confirmation message
                div.innerHTML = `
                    <p>${msg.text}</p>
                    <p class="confirmation-message">Offer Accepted, Our Collecting team will reach the given location within 2-3 working days!</p>
                `;
            }

                else{    // div.textContent = msg;
                    div.innerHTML = `
                <p>${msg.text}</p>
                <button onclick="openDeliveryForm()">Accept Offer</button>
                <button onclick="cancelSelling()">Cancel Selling</button>
            `;
                }
                    div.style.border="2px solid green"
                    content.appendChild(div);
                });

                menu.style.display = "block";
            } else {
                content.innerHTML = "<div class='notification'>No new notifications</div>";
                menu.style.display = "block";
            }
        }





        function openDeliveryForm() {
            document.getElementById("notification-menu").style.display = "none";
            document.getElementById("delivery-form-container").style.display = "block";
        }

        function closeDeliveryForm() {
            document.getElementById("delivery-form-container").style.display = "none";
        }

        document.getElementById("delivery-form").addEventListener("submit", function (e) {
            e.preventDefault();

            let deliveryData = {
                user_id: document.getElementById("delivery-user-id").value,
                user_email: document.getElementById("delivery-user-email").value,
                user_contact: document.getElementById("delivery-user-contact").value,
                delivery_pincode: document.getElementById("delivery-pincode").value,
                delivery_location: document.getElementById("delivery-location").value,
                state: document.getElementById("delivery-state").value,
                product_id: document.getElementById("product_id").value,
                org_id: document.getElementById("organisation_id").value,
            };

            fetch("/submit_delivery_details", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(deliveryData)
            })
                .then(response => response.json())
                .then(data => {
                    alert(data.message);
                    closeDeliveryForm();
                })
                .catch(error => console.error("Error submitting delivery details:", error));
                fetchNotifications()
        });

        
        async function cancelSelling() {
            alert("You have canceled the selling offer.");
        }





       
        function closeNotifications() {
            document.getElementById("notification-menu").style.display = "none";
        }



        function toggleWalletInfo() {
            var walletInfo = document.getElementById("wallet-info");
            walletInfo.style.display = (walletInfo.style.display === "block") ? "none" : "block";
        }

       
        document.addEventListener("click", function (event) {
            var walletInfo = document.getElementById("wallet-info");
            var walletIcon = document.querySelector(".walleticon");

            if (walletInfo.style.display === "block" &&
                event.target !== walletIcon &&
                !walletInfo.contains(event.target)) {
                walletInfo.style.display = "none";
            }
        });



        document.addEventListener("DOMContentLoaded", function () {
            fetch("/get_organizations")
                .then(response => response.json())
                .then(data => {
                    console.log("📢 Fetched Organizations:", data);

                    const container = document.querySelector(".card-grid"); 
                    container.innerHTML = ""; 

                    data.forEach(org => {
                        const card = document.createElement("div");
                        card.classList.add("card");
                        card.innerHTML = `
                    <div class="card-content">
                        <h2>Organisation: ${org.name}</h2>
                        <p>Email: ${org.email}</p>
                        <p class="ratings-text" data-orgid="${org.uid}" onclick="fetchReviews('${org.uid}')">⭐ Ratings & Reviews</p>
                    </div>
                    <button class="review-btn" data-orgid="${org.uid}">Share Review</button>
                 `;
                        container.appendChild(card);
                    });

                    




                    document.querySelectorAll(".review-btn").forEach(button => {
                button.addEventListener("click", function () {
                    const orgId = this.getAttribute("data-orgid");
                    openReviewModal(orgId);
                });
            });



                    const orgList = document.querySelector("#org-list"); 
                    orgList.innerHTML = ""; 

                    data.forEach(org => {
                        const checkbox = document.createElement("label");
                        checkbox.innerHTML = `
                    <input type="checkbox" class="org-checkbox" value="${org.uid}">
                    ${org.name}
                `;
                        orgList.appendChild(checkbox);
                    });

                })
                .catch(error => console.error("❌ Error fetching organizations:", error));
        });





        const modal = document.getElementById("reviewModal2");
const closeModal = document.querySelector(".close");

function openReviewModal(orgId) {
    document.getElementById("orgId").value = orgId;
    modal.style.display = "block";
}

closeModal.addEventListener("click", () => {
    modal.style.display = "none";
});

window.onclick = (event) => {
    if (event.target === modal) {
        modal.style.display = "none";
    }
};






        function logout() {
            fetch("http://127.0.0.1:5000/logout", {
                method: "POST",
                credentials: "include"
            }).then(() => {
                window.location.href = "/"; 
            }).catch(error => console.error("Logout Error:", error));
        }


        document.getElementById("file-input").addEventListener("change", function (event) {
            let file = event.target.files[0];
            if (file) {
                let reader = new FileReader();
                reader.onload = function (e) {
                    let img = document.getElementById("uploaded-image");
                    img.src = e.target.result;
                    img.style.display = "block"; 
                };
                reader.readAsDataURL(file);
            }
        });

        document.querySelector("#upload-form").onsubmit = async function (e) {
            e.preventDefault();
            let formData = new FormData(this);
            let response = await fetch("/predict", {
                method: "POST",
                body: formData
            });
            let result = await response.json();
            let stepsDiv = document.getElementById("handling-steps");

            if (result.prediction === "Can't Determine") {
                document.getElementById("result").innerHTML = `<h3>Prediction: Can't Determine</h3>`;
                stepsDiv.style.display = "none";
            } else {
                document.getElementById("result").innerHTML =
                    `<h3>Product: ${result.prediction}</h3>
                 <p>Confidence: ${result.confidence}</p>`;

                let stepsHtml = `<h3>How to Manage This Product?</h3><ul>`;
                result.handling_steps.forEach(step => {
                    stepsHtml += `<li>${step}</li>`;
                });
                stepsHtml += `</ul>`;

                stepsDiv.innerHTML = stepsHtml;
                stepsDiv.style.display = "block";
            }



          
        };








      

        function toggleOrgSelection() {
            const selection = document.getElementById("send-option").value;
            document.getElementById("org-selection").style.display = selection === "selected" ? "block" : "none";
        }

        async function submitEwaste() {
            const productName = document.getElementById("product-name").value;
            const productAge = document.getElementById("product-age").value;
            const productBrand = document.getElementById("product-brand").value;
            const productModel = document.getElementById("product-model").value;
            const productDescription = document.getElementById("product-description").value;
            const userId = document.getElementById("user-id").value;
            const email = document.getElementById("email").value;

            const sendOption = document.getElementById("send-option").value;
            let selectedOrganizations = [];

            if (sendOption === "selected") {
                document.querySelectorAll(".org-checkbox:checked").forEach(checkbox => {
                    selectedOrganizations.push(checkbox.value);
                });
            } else {
                selectedOrganizations.push("all"); 
            }

            const productData = {
                product_name: productName,
                product_age: productAge,
                brand: productBrand,
                model: productModel,
                description: productDescription,
                user_id: userId,
                email: email,
                organizations: selectedOrganizations
            };


            try {
                const response = await fetch("http://127.0.0.1:5000/submit_product", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(productData)
                });

                if (!response.ok) {
                    throw new Error(`Server error: ${response.status}`);
                }

                const result = await response.json();
                alert(result.message || "Product submitted successfully!");
            } catch (error) {
                console.error("Error submitting product:", error);
                alert("Failed to submit product. Please try again.");
            }

        }





        document.getElementById("reviewForm").addEventListener("submit", async function(event) {
    event.preventDefault(); // Prevent default form submission

    const orgId = document.getElementById("orgId").value;
    const userId = document.getElementById("userId").value;
    const message = document.getElementById("message").value;
    const rating = document.getElementById("rating").value;

    const reviewData = { orgId, userId, message, rating };

    try {
        const response = await fetch("http://127.0.0.1:5000/submit-review", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(reviewData)
        });

        const result = await response.json();
        if (response.ok) {
            alert("Review submitted successfully!");
            document.getElementById("reviewForm").reset(); // Reset form after submission
            document.getElementById("reviewModal2").style.display = "none"; // Close modal
        } else {
            alert("Error: " + result.error);
        }
    } catch (error) {
        console.error("Error submitting review:", error);
    }
});


function fetchReviews(orgId) {
    console.log("Fetching reviews for orgId:", orgId); 
    fetch(`/get-reviews?orgId=${orgId}`)
        .then(response => response.json())
        .then(data => {
            console.log("Received reviews:", data);
            if (data.success) {
                displayReviews(data.reviews);
            } else {
                alert("No reviews found for this organization!");
            }
        })
        .catch(error => {
            console.error("Error fetching reviews:", error);
        });
}

function displayReviews(reviews) {
    console.log("Displaying reviews:", reviews); 
    const reviewsContainer = document.getElementById("reviewsContainer");
    reviewsContainer.innerHTML = ""; // Clear previous reviews

    if (reviews.length === 0) {
        reviewsContainer.innerHTML = "<p>No reviews available.</p>";
        return;
    }

    reviews.forEach(review => {
        const reviewElement = document.createElement("div");
        reviewElement.classList.add("review-card");
        reviewElement.innerHTML = `
            <p><strong>${review.userName}</strong> (${review.rating} ⭐)</p>
            <p>${review.message}</p>
            <hr>
        `;
        reviewsContainer.appendChild(reviewElement);
    });

    document.getElementById("reviewsModal").style.display = "flex";
}

function closeReviewsModal() {
    document.getElementById("reviewsModal").style.display = "none";
}

    </script>

</body>

</html>